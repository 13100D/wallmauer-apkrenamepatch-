plugins {
    id 'java-conventions'
    id 'application'
}

application {
    mainClass.set("de.uni_passau.fim.auermich.instrumentation.branchdistance.BranchDistance")
}

task customFatJar(type: Jar) {

    manifest {
        attributes 'Main-Class': 'de.uni_passau.fim.auermich.instrumentation.branchdistance.BranchDistance'
    }

    archiveFileName.set('branchDistance.jar')

    from {
        (configurations.compile.findAll { !it.path.endsWith(".pom") }).collect {
            it.isDirectory() ? it : zipTree(it) }

        (configurations.runtimeClasspath.findAll { !it.path.endsWith(".pom") }).collect {
            it.isDirectory() ? it : zipTree(it) }
    }

    with jar
}
